<% @title ||= 'Queued Tweets'; title @title %>
<%= go_back_btn mturk_batch_jobs_path %>

<div class="row justify-content-center mb-4">
  <div class="col-12">
    <h2 class='mb-5'>
      In queue for '<%= @mturk_batch_job.name %>'
    </h2>
  </div>
  <div class="col-md-6 mb-5">
    <div class="card">
      <div class="card-body">
        <table class="table vertical-align borderless-table">
          <%= table_row('Total', @mturk_batch_job.num_tweets) %>
          <%= table_row('&#8226;'.html_safe + ' Available', @mturk_batch_job.mturk_tweets.available.count) %>
          <%= table_row('&#8226;'.html_safe + ' Unavailable', @mturk_batch_job.mturk_tweets.unavailable.count) %>
          <%= table_row('&#8226;'.html_safe + ' Unknown', @mturk_batch_job.mturk_tweets.unknown.count) %>
        </table>
      </div>
    </div>
  </div>
  <div class="col-md-6">
  </div>
</div>


<div class="row justify-content-center mb-4">
  <div class="col-12">
    <%= paginate @mturk_tweets %>
  </div>
</div>

<div class="row justify-content-center mb-4">
  <div class="col-12">
    <table class="table">
      <thead>
        <tr>
          <th>Tweet Id</th>
          <th>Tweet text</th>
          <th>Num workers</th>
          <th>Availability
            <% if @mturk_tweets.unknown.count > 0 %>
              <span id="refresh-availability">
                <%= link_to fa_icon('refresh'), update_availability_mturk_batch_job_mturk_tweets_path(@mturk_batch_job), class: 'ml-2', title: 'Check availability', remote: true %>
              </span>
              <span id="refresh-availability-running" style="display:none;">
                <div class="spinner-small ml-2" id="refresh-availability-spinner" style='display:inline-block;'></div>
              </span>
            <% end %>
          </th>
        </tr>
      </thead>
      <tbody>
        <%= render @mturk_tweets %>
      </tbody>
    </table>
  </div>
</div>
